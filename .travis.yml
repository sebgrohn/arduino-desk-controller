language: python
python:
  - "2.7"

# Cache PlatformIO packages using Travis CI container-based infrastructure
sudo: false
cache:
  directories:
    - "~/.platformio"

env:
  - PLATFORMIO_CI_SRC=. BOARD=leonardo

install:
  - pip install -U platformio
  - platformio lib install 44  # Time
  - platformio lib install 68  # TimeAlarms

  - wget https://github.com/thomasfredericks/Bounce2/archive/V2.1.zip -O /tmp/Bounce2.zip
  - unzip /tmp/Bounce2.zip -d /tmp/
  - mv /tmp/Bounce2-* /tmp/Bounce2

  - wget https://github.com/maniacbug/StandardCplusplus/archive/af18241.zip -O /tmp/StandardCplusplus.zip
  - unzip /tmp/StandardCplusplus.zip -d /tmp/
  - mv /tmp/StandardCplusplus-* /tmp/StandardCplusplus

script:
  - platformio ci --lib="/tmp/Bounce2" --lib="/tmp/StandardCplusplus" --board=$BOARD

notifications:
  email:
    on_success: change
    on_failure: change
